function getCsrfToken(){return $('input[name="csrf_token"]').val()}$(function(){$(".toast").each(function(){new bootstrap.Toast(this).show()}),$("#post_storefront").on("submit",function(e){e.preventDefault();e=new FormData(this);e.append("post_storefront","1"),e.append("csrf_token",getCsrfToken()),$.ajax({type:"POST",url:"./includes/post_admin.php",data:e,processData:!1,contentType:!1,success:function(){location.reload()}})});let o,a=0;function s(){setTimeout(()=>location.reload(),3e3)}var n;$("#fileupload").fileupload({acceptFileTypes:/(\.|\/)(zip)$/i,autoUpload:!1,progressall:function(e,t){t=parseInt(t.loaded/t.total*100,10);$("#progress .progress-bar").css("width",t+"%")}}),$("#fileupload").on("submit",function(e){e.preventDefault();e=$("#fileupload").fileupload("option","files");e&&0!==e.length?(o=e.length,a=0,e.forEach(e=>{var t=new FormData;t.append("file",e),$.ajax({url:$("#fileupload").attr("action"),type:"POST",data:t,cache:!1,contentType:!1,processData:!1,success:function(e){document.querySelector("#toast-1 .toast-body").innerHTML=e.includes("Module zip file extracted successfully.")?"Success! Module added Successfully.":"There was a problem adding the Module.",$(".toast").addClass("show")},complete:function(){a++,o===a&&s()},error:function(){a++,o===a&&s()},xhr:function(){var e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",function(e){e.lengthComputable&&(e=e.loaded/e.total*100,$("#progress .progress-bar").css("width",e+"%"))},!1),e}})})):alert("No file selected!")}),$("#fileupload").on("fileuploadchange",function(){$("#fileupload .empty-row").hide()}),$("#fileupload").on("fileuploadfail",function(e,t){"abort"===t.errorThrown&&1===$("#fileupload .files tr").not(".empty-row").length&&$("#fileupload .empty-row").show()}),$(document).on("click",".btn-panel-edit",function(e){e.preventDefault(),n=$(this).data("panel"),$("#panelSettingsModal .modal-body").empty(),$("#panelSettingsModal").modal("show"),console.log("Retrieved panelName:",n),$.ajax({url:"includes/get_admin.php",data:{panelName:n},success:function(e){var s;console.log("Received files:",e),e&&"object"==typeof e&&0<Object.keys(e).length?(s={},$.each(e,function(e,t){var o;t.trim().endsWith(".json")&&(o=t.split("/").pop(),/^cockpit_[^_]+_admin_(.+)\.json/.test(o))&&$.getJSON("panel/"+n+"/includes/db/"+t+"?_t="+(new Date).getTime()).done(function(e){var a,t=o.replace(/^cockpit_[^_]+_admin_(.+)\.json/,"$1");s[t]={fileName:o,data:e},t=t,(e=e)&&"object"==typeof e?(a="",a+='<h4 class="card-title mb-3">'+t.replace(/_/g," ").toUpperCase()+"</h4>",$.each(e,function(e,t){console.log("Processing key:",e,"with value:",t,"type:",typeof t);var o=e.replace(/_/g," "),o=(a=(a=a+'<div class="card">'+'<div class="card-body d-flex align-items-center">')+('<span class="me-auto">'+o+"</span>")+'<div class="form-check form-switch">',!1);"boolean"==typeof t?o=t:"string"==typeof t?o="true"===t.toLowerCase()||"1"===t:"number"==typeof t&&(o=1===t),a=a+'<input class="form-check-input" type="checkbox" id="'+e+'"'+(o?" checked":"")+'></div></div><div class="card-arrow"><div class="card-arrow-top-left"></div><div class="card-arrow-top-right"></div><div class="card-arrow-bottom-left"></div><div class="card-arrow-bottom-right"></div></div></div>'}),a+='<div class="mb-3"></div><div class="d-flex justify-content-end"></div>',$("#panelSettingsModal .modal-body").append(a)):console.error("Invalid data format:",e)}).fail(function(e,t,o){console.error("Error fetching JSON:",o)})}),$("#panelSettingsModal .btn-primary").data("settingsWithFiles",s)):(console.log("No JSON files found."),$("#panelSettingsModal .modal-body").append('<h4 class="card-title mb-3">No Settings Found</h4>'))},error:function(e,t,o){console.error("Error fetching files:",o)}})}),$(document).on("click","#panelSettingsModal .btn-primary",function(){var o={},e=$(this).data("settingsWithFiles");$("#panelSettingsModal .form-check-input").each(function(){var e=$(this).attr("id"),t=$(this).is(":checked");o[e]=t}),$.ajax({url:"includes/update_admin.php",method:"POST",data:{panelName:n,updatedData:o,settingsWithFiles:e},success:function(e){$("#panelSettingsModal").modal("hide"),location.reload()},error:function(e,t,o){console.error("Error updating data:",o)}})}),$(document).on("click",".btn-sidebar-settings-edit",function(){n=$(this).data("sidebar"),$.getJSON("panel/"+n+"/panel_info.json?_t="+(new Date).getTime()).done(function(e){e=e,$("#sidebarSettingsModal .modal-body").empty(),$("#sidebarSettingsModal").modal("show"),e.pages&&0<e.pages.length?$.each(e.pages,function(e,t){var o='<div class="card">',o=(o=(o=(o=(o=(o=(o=(o+='<div class="card-body d-flex align-items-center">')+('<span class="me-auto">'+t.title+"</span>")+'<div class="form-check form-switch">')+('<input class="form-check-input" type="checkbox" id="page-'+e+'"')+(t.enabled?" checked":""))+">"+"</div>")+"</div>"+'<div class="card-arrow">')+'<div class="card-arrow-top-left"></div>'+'<div class="card-arrow-top-right"></div>')+'<div class="card-arrow-bottom-left"></div>'+'<div class="card-arrow-bottom-right"></div>')+"</div>"+"</div>";$("#sidebarSettingsModal .modal-body").append(o)}):$("#sidebarSettingsModal .modal-body").append('<h4 class="card-title mb-3">No Menu Pages Found</h4>')}).fail(function(e,t,o){console.error("Error fetching panel_info.json:",o)})}),$(document).on("click","#sidebarSettingsModal .btn-primary",function(){var a=[];$("#sidebarSettingsModal .form-check-input").each(function(e,t){var o={title:$(this).siblings(".form-check-label").text(),enabled:$(this).is(":checked")};a.push(o)}),$.getJSON("panel/"+n+"/panel_info.json?_t="+(new Date).getTime()).done(function(e){e.pages.forEach(function(e,t){e.enabled=a[t].enabled});e=JSON.stringify(e);$.ajax({url:"includes/update_panel_info.php",method:"POST",data:{panelName:n,panelInfo:e},success:function(e){console.log("Panel info updated successfully:",e),$("#sidebarSettingsModal").modal("hide"),location.reload()},error:function(e,t,o){console.error("Error updating panel_info.json:",o)}})}).fail(function(e,t,o){console.error("Error fetching panel_info.json:",o)})})}),$("#datatableVisits").DataTable({dom:"<'row mb-3'<'col-sm-4'l><'col-sm-8 text-end'<'d-flex justify-content-end'fB>>>t<'d-flex align-items-center'<'me-auto'i><'mb-0'p>>",lengthMenu:[10,20,30,40,50],responsive:!0,buttons:[{extend:"csv",className:"btn-sm btn-outline-theme"}]});var dates=Object.keys(data_users).slice(-14),users=dates.map(e=>data_users[e].total_users),topPagesSeries=[];for(const wa of dates){const xa=data_users[wa].top_pages.slice(0,3);for(const ya of xa){const za=topPagesSeries.findIndex(e=>e.name===ya.page);-1!==za?topPagesSeries[za].data.push(ya.visits):topPagesSeries.push({name:ya.page,type:"bar",data:[ya.visits]})}}var apexMixedChartOptions={chart:{height:350,type:"line",stacked:!0,foreColor:"#ffffff"},dataLabels:{enabled:!1},series:[{name:"Visitors",type:"line",color:"#ffffff",data:users},...topPagesSeries],colors:["#ffffff"],theme:{monochrome:{enabled:!0,color:app.color.theme,shadeTo:"dark",shadeIntensity:.65}},xaxis:{categories:dates,axisBorder:{show:!0,color:"#ffffff",height:1,width:"100%",offsetX:0,offsetY:-1},axisTicks:{show:!0,color:"#ffffff",height:6,offsetX:0,offsetY:0},labels:{style:{colors:"#ffffff"}}},yaxis:{labels:{formatter:function(e){return e},style:{colors:"#ffffff"}},title:{text:"Visitor Count",style:{color:"#ffffff"}}},tooltip:{fixed:{enabled:!0,position:"topLeft",offsetY:30,offsetX:60},style:{color:"#ffffff"}},legend:{horizontalAlign:"left",offsetX:40,labels:{colors:"#ffffff"}}},apexMixedChart=new ApexCharts(document.querySelector("#apexMixedChart"),apexMixedChartOptions);function deleteStorefront(e){confirm("Are you sure you want to delete this storefront?")&&$.ajax({type:"POST",url:"./includes/post_admin.php",data:{delete_storefront:1,id:e,csrf_token:getCsrfToken()},success:function(){location.reload()}})}function editStorefront(e,t){$("#store_name").val(e),$("#api_url").val(t),$('#add_storefront button[name="add_storefront"]').text('<i class="fas fa-plus me-1"></i>Update Storefront')}apexMixedChart.render();
//# sourceMappingURL=admin.js.map
